---
interface NavItem {
  name: string;
  url: string;
  label: string;
}

interface SocialItem {
  name: string;
  url: string;
  icon: string;
  ariaLabel: string;
}

const NAV_ITEMS: NavItem[] = [
  { name: "Sobre Mí", url: "#about", label: "Ir a la sección sobre mí" },
  { name: "Stack", url: "#skills", label: "Ver mis habilidades técnicas" },
  {
    name: "Proyectos",
    url: "#projects",
    label: "Ver mis proyectos destacados",
  },
  {
    name: "Recomendaciones",
    url: "#recommendations",
    label: "Ver mis recomendaciones",
  },
];

const SOCIAL_LINKS: SocialItem[] = [
  {
    name: "GitHub",
    url: "https://github.com/andreyVasquez",
    icon: "code",
    ariaLabel: "Visitar perfil de GitHub de Andrey",
  },
  {
    name: "LinkedIn",
    url: "https://www.linkedin.com/in/andrey--vasquez/",
    icon: "work",
    ariaLabel: "Visitar perfil de LinkedIn de Andrey",
  },
];
---

<header
  class="fixed top-0 left-0 right-0 z-50 border-b border-gray-200 dark:border-surface-dark-hover bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md transition-colors duration-300"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <a
        href="/"
        class="flex items-center gap-3 group text-left focus:outline-none focus:ring-2 focus:ring-primary rounded-lg p-1"
        aria-label="Volver al inicio"
      >
        <div
          class="flex items-center justify-center size-8 rounded-lg bg-primary text-white group-hover:bg-primary-dark transition-colors"
          aria-hidden="true"
        >
          <span class="material-symbols-outlined text-[20px]">terminal</span>
        </div>
        <div>
          <span
            class="block text-base font-bold leading-tight tracking-tight text-gray-900 dark:text-white"
          >
            Andrey Vasquez
          </span>
          <span
            class="block text-xs text-gray-500 dark:text-text-secondary font-medium"
          >
            Shopify & E-commerce Senior Dev
          </span>
        </div>
      </a>

      <div class="hidden lg:flex items-center gap-8">
        <nav aria-label="Navegación principal">
          <ul class="flex gap-6">
            {
              NAV_ITEMS.map((item) => (
                <li>
                  <a
                    class="text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-colors focus:outline-none focus:text-primary"
                    href={item.url}
                    aria-label={item.label}
                  >
                    {item.name}
                  </a>
                </li>
              ))
            }
          </ul>
        </nav>

        <div class="h-4 w-px bg-gray-300 dark:bg-gray-700" role="separator">
        </div>

        <div class="flex gap-2">
          <button
            id="theme-toggle"
            class="flex items-center justify-center size-9 rounded-lg bg-gray-200 dark:bg-surface-dark hover:bg-gray-300 dark:hover:bg-surface-dark-hover transition-all text-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
            aria-label="Alternar entre modo claro y oscuro"
          >
            <span id="theme-icon" class="material-symbols-outlined text-[20px]"
              >light_mode</span
            >
          </button>

          {
            SOCIAL_LINKS.map((link) => (
              <a
                aria-label={link.ariaLabel}
                class="flex items-center justify-center size-9 rounded-lg bg-gray-200 dark:bg-surface-dark hover:bg-gray-300 dark:hover:bg-surface-dark-hover transition-all text-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary"
                href={link.url}
                target="_blank"
                rel="noopener noreferrer"
              >
                <span
                  class="material-symbols-outlined text-[20px]"
                  aria-hidden="true"
                >
                  {link.icon}
                </span>
              </a>
            ))
          }

          <a
            class="flex items-center justify-center h-9 px-4 rounded-lg bg-primary hover:bg-primary-dark text-white text-sm font-bold transition-all ml-2 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary"
            href="https://api.whatsapp.com/send?phone=573128805228&text=%F0%9F%9A%80%20Hola%2C%20tengo%20interes%20en%20contactarte"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Agendar una reunión de 30 minutos en Calendly"
          >
            Contacto
          </a>
        </div>
      </div>

      <div class="lg:hidden flex items-center gap-1 md:gap-4">
        <button
          id="theme-toggle-mobile"
          class="flex items-center justify-center size-9 rounded-lg bg-gray-200 dark:bg-surface-dark text-gray-700 dark:text-white focus:outline-none"
          aria-label="Alternar modo oscuro"
        >
          <span
            id="theme-icon-mobile"
            class="material-symbols-outlined text-[20px]">light_mode</span
          >
        </button>

        <button
          id="mobile-menu-btn"
          class="flex items-center text-gray-600 dark:text-white p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors focus:outline-none focus:ring-2 focus:ring-primary"
          aria-label="Abrir menú de navegación"
          aria-expanded="false"
          aria-controls="mobile-menu"
        >
          <span class="material-symbols-outlined" aria-hidden="true">menu</span>
        </button>
      </div>
    </div>
  </div>

  <div
    id="mobile-menu"
    class="hidden lg:hidden absolute top-16 left-0 w-full bg-white dark:bg-background-dark border-b border-gray-200 dark:border-gray-800 shadow-lg"
  >
    <nav class="flex flex-col p-4 gap-4">
      {
        NAV_ITEMS.map((item) => (
          <a
            href={item.url}
            class="text-gray-700 dark:text-gray-200 font-medium py-2 hover:text-primary dark:hover:text-primary"
          >
            {item.name}
          </a>
        ))
      }
    </nav>
  </div>
</header>

<script is:inline>
  const menuBtn = document.getElementById("mobile-menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");

  if (menuBtn && mobileMenu) {
    menuBtn.addEventListener("click", () => {
      const isExpanded = menuBtn.getAttribute("aria-expanded") === "true";
      menuBtn.setAttribute("aria-expanded", (!isExpanded).toString());
      mobileMenu.classList.toggle("hidden");

      const iconSpan = menuBtn.querySelector("span");
      if (iconSpan) iconSpan.textContent = isExpanded ? "menu" : "close";
    });
  }

  const themeToggles = document.querySelectorAll(
    "#theme-toggle, #theme-toggle-mobile"
  );

  const updateIcons = (isDark) => {
    const iconName = isDark ? "light_mode" : "dark_mode";
    document
      .querySelectorAll("#theme-icon, #theme-icon-mobile")
      .forEach((span) => {
        span.textContent = iconName;
      });
  };

  const isDarkInitial = document.documentElement.classList.contains("dark");
  updateIcons(isDarkInitial);

  themeToggles.forEach((btn) => {
    btn.addEventListener("click", () => {
      const html = document.documentElement;

      if (html.classList.contains("dark")) {
        html.classList.remove("dark");
        localStorage.setItem("theme", "light");
        updateIcons(false);
      } else {
        html.classList.add("dark");
        localStorage.setItem("theme", "dark");
        updateIcons(true);
      }
    });
  });
</script>
